# 面试笔记

##  redis

### 1. redis切片集群

**哈希槽的数量**： 16384

**客户端通过key查询redis实例的过程**: 

key(通过**CRC16**计算) --> 哈希槽(通过客户端的哈希槽映射的缓存) --> redis实例

**客户端请求数据面临的问题**：

(1) 数据分布在哪个实例上？

```shell
Redis Cluster 方案采用哈希槽（Hash Slot），来处理数据和实例之间的映射关系

哈希槽信息扩散：
（1）redis拥有所有哈希槽信息：redis实例会把自己的哈希槽信息发给和它相连接的实例。
客户端对哈希槽信息的处理：
（1）客户端和集群实例建立连接后，实例会把哈希槽信息发给客户端。
（2）客户端收到哈希槽信息后，会把哈希槽信息缓存在本地。
```

(2) 客户端怎么确定数据在哪个实例上？

```shell
实例和哈希槽关系变化的原因：
（1）集群新增或者删除实例
（2）为了负载均衡，重新分配哈希槽

Redis Cluster重定向机制
（1） MOVED （可以认为是永久重定向，哈希槽的所有key全部迁移） 
让客户端去新实例进行请求。同时会更新客户端缓存的哈希槽信息。
MOVED 13320 172.16.19.5:6379   (MOVED 哈希槽 redis实例地址)
（2） ASK （可以认为是临时重定向，部分迁移） 
客户端向实例发送ASKING命令，这个命令的含义是让这个实例允许客户端接下来发送的命令。
然后，客户端再发送实际的执行命令。
ASK命令并不会更新客户端缓存的哈希槽分配信息
ASK 13320 172.16.19.5:6379     (ASK 哈希槽 redis实例地址)
```

**集群的核心问题： 哈希槽与实例的关系**  

### 2. redis如何将数据写入更快？

(1) 批量操作

mset、hmset等批量操作命令

lua脚本执行批量命令



## 数据结构与算法

### 1. B树

(1) B树的叶子节点满的情况下，插入一个新节点，会如何变化？



## docker

### 1. docker的容器与宿主机如何通信？

docker会默认创建docker0的桥接，用来连接它的子网。

容器创建时会创建成对虚拟以太网(veth pair)，一个在容器上，一个在docker0上，容器可以与docker0直接进行通信。

docker0通过nat与宿主机进行通信。

<img src="D:\文档\markdown笔记\面试\docker网络.png" alt="docker网络" style="zoom:67%;" />

